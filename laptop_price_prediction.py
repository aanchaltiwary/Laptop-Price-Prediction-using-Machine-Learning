# -*- coding: utf-8 -*-
"""Laptop_Price_Prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1gkaQJgCZ8bHuMBEngJMGn9MMWVS9Q8jI
"""

#Feature Engineering

import pandas as pd
df = pd.read_csv('laptop_price.csv')
df

df.head(2)

df.columns

df.info()

df = df.drop(columns=['laptop_ID','ScreenResolution','Cpu','Memory','Gpu'])
df

df.nunique()

df['Product'] = df['Product'].apply(lambda x:x.split(' ')[0])
df

df['Ram'] = df['Ram'].apply(str).str.replace('GB','').astype(int)
df

df['Weight'] = df['Weight'].apply(str).str.replace('kg','').astype(float)
df

df.isnull().sum()

#Encode string into numeric
#one hot encoding
df=pd.get_dummies(df.copy(),drop_first=True)
df

x = df.drop(columns=['Price_euros'])
y = df.iloc[:,[3]].values

#splitting and train & test
from sklearn.model_selection import train_test_split
x_train,x_test,y_train,y_test=train_test_split(x,y,random_state=0)

print(x_train.shape)
print(x_test.shape)
#75:25

from sklearn.linear_model import LinearRegression
model = LinearRegression()
model.fit(x_train,y_train)

y_pred = model.predict(x_test)
y_pred

from sklearn.metrics import mean_squared_error
mean_squared_error(y_pred,y_test)

model.score(x_test,y_test)



